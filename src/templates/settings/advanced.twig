{% extends "smart-links/_layouts/settings" %}
{% set title = "Advanced Settings"|t('smart-links') %}
{% set fullPageForm = true %}
{% set selectedSettingsItem = 'advanced' %}

{% set plugin = craft.app.plugins.getPlugin('smart-links') %}{% set crumbs = [
    {
        label: plugin.settings.pluginName|t('smart-links'),
        url: url('smart-links'),
    },
    {
        label: 'Settings'|t('smart-links'),
        url: url('smart-links/settings'),
    },
    {
        label: 'Advanced'|t('smart-links'),
        url: url('smart-links/settings/advanced'),
    },
] %}

{% import "_includes/forms" as forms %}

{% block content %}
    <form method="post" accept-charset="UTF-8">
        {{ actionInput('smart-links/settings/save') }}
        {{ csrfInput() }}
        {{ redirectInput('smart-links/settings/advanced') }}

        <h2>{{ "Advanced Settings"|t('smart-links') }}</h2>

        {{ forms.lightswitchField({
            label: "Cache Device Detection"|t('smart-links'),
            instructions: "Cache device detection results for better performance"|t('smart-links'),
            id: 'cacheDeviceDetection',
            name: 'settings[cacheDeviceDetection]',
            on: settings.cacheDeviceDetection ?? true,
            disabled: settings.isOverriddenByConfig('cacheDeviceDetection'),
            warning: settings.isOverriddenByConfig('cacheDeviceDetection') ? 
                "This is being overridden by the <code>cacheDeviceDetection</code> setting in <code>config/smart-links.php</code>."|t('smart-links')|raw : null,
        }) }}

        {{ forms.textField({
            label: "Device Detection Cache Duration"|t('smart-links'),
            instructions: "Cache duration in seconds"|t('smart-links'),
            id: 'deviceDetectionCacheDuration',
            name: 'settings[deviceDetectionCacheDuration]',
            value: settings.deviceDetectionCacheDuration ?? 3600,
            type: 'number',
            min: 0,
            disabled: settings.isOverriddenByConfig('deviceDetectionCacheDuration'),
            warning: settings.isOverriddenByConfig('deviceDetectionCacheDuration') ? 
                "This is being overridden by the <code>deviceDetectionCacheDuration</code> setting in <code>config/smart-links.php</code>."|t('smart-links')|raw : null,
        }) }}

        <div class="buttons">
            <button type="submit" class="btn submit">{{ "Save Settings"|t('smart-links') }}</button>
        </div>
    </form>
{% endblock %}